# 注册功能实现说明

## 概述
本项目实现了一个完整的用户注册流程，包括邮箱验证功能。注册流程分为三个步骤：
1. 基本信息填写（邮箱、用户名、密码）
2. 邮箱验证码验证
3. 注册成功页面

## 文件结构

### ViewModels
- `RegisterViewModel.swift` - 注册流程的核心视图模型，管理所有注册逻辑和状态

### Views
- `RegisterView.swift` - 注册主视图，根据当前步骤显示不同的子视图
- `RegisterBasicInfoView.swift` - 基本信息填写视图（第一步）
- `RegisterVerificationView.swift` - 验证码输入视图（第二步）
- `RegisterSuccessView.swift` - 注册成功视图（第三步）

### 修改的文件
- `LoginView.swift` - 添加了注册按钮的sheet展示功能

## 功能特性

### 1. 表单验证
- **邮箱验证**：检查邮箱格式是否正确
- **用户名验证**：长度3-20个字符，只允许字母、数字和下划线
- **密码验证**：至少8个字符，包含大小写字母、数字和特殊字符
- **确认密码验证**：确保两次输入的密码一致

### 2. 实时反馈
- 输入框边框颜色根据验证状态变化（红色=无效，绿色=有效）
- 显示具体的错误提示信息
- 下一步按钮只有在所有字段都有效时才可用

### 3. 验证码功能
- 60秒倒计时功能
- 可重新发送验证码
- 6位数字验证码验证

### 4. 用户体验
- 加载状态显示
- 错误提示（Alert）
- 键盘自动跳转
- 密码显示/隐藏切换

## 使用说明

### 从登录页面访问注册
在登录页面点击"注册新账号"按钮，即可弹出注册sheet。

### 注册流程
1. **填写基本信息**
   - 输入有效的邮箱地址
   - 输入符合要求的用户名
   - 输入符合要求的密码
   - 确认密码
   - 点击"下一步"或导航栏的"下一步"按钮

2. **验证邮箱**
   - 检查邮箱收到的6位数验证码
   - 输入验证码
   - 点击"验证"或导航栏的"验证"按钮
   - 可点击"重新发送"获取新的验证码（60秒冷却时间）

3. **注册成功**
   - 显示注册成功信息
   - 显示用户注册的用户名和邮箱
   - 可选择"立即登录"或"返回首页"

## 技术实现

### 状态管理
使用`@Published`属性包装器和`ObservableObject`协议实现响应式状态管理。

### 验证逻辑
使用Combine框架实现实时验证，通过`$property.map.validation.eraseToAnyPublisher()`模式。

### 导航流程
使用枚举`RegisterStep`管理注册流程的三个步骤，通过`NavigationView`和`Toolbar`实现导航。

### 模拟API调用
当前使用`DispatchQueue.main.asyncAfter`模拟网络请求，实际项目中应替换为真实的API调用。

## 自定义和扩展

### 修改验证规则
在`RegisterViewModel.swift`中修改相应的验证函数：
- `isValidEmail(_:)` - 邮箱验证
- `isValidUsername(_:)` - 用户名验证
- `isValidPassword(_:)` - 密码验证

### 修改UI样式
各个视图文件都使用了模块化的设计，可以独立修改每个视图的样式而不影响其他部分。

### 添加更多注册步骤
1. 在`RegisterStep`枚举中添加新的步骤
2. 创建对应的视图文件
3. 在`RegisterView`中添加相应的显示逻辑

### 集成真实API
1. 替换`RegisterViewModel`中的模拟API调用
2. 添加错误处理和重试机制
3. 集成实际的邮件发送服务

## 注意事项

1. 当前实现为演示版本，使用了模拟数据
2. 实际部署时需要添加真实的后端API集成
3. 建议添加更多的安全措施，如密码强度指示器、验证码防刷机制等
4. 考虑添加用户协议和隐私政策的确认步骤